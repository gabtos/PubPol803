"0","library(useful)"
"0",""
"0","# Select relevant columns and ensure they are numeric"
"0","parkTrainingSet <- parkdata %>%"
"0","  select(city, pct_near_park_data, spend_per_resident_data, park_pct_city_data) %>%"
"0","  mutate(across(c(pct_near_park_data, spend_per_resident_data), as.numeric))"
"0",""
"0","# Remove rows with NAs"
"0","parkTrain <- na.omit(parkTrainingSet)"
"0",""
"0","# Check the structure to ensure the numeric data"
"0","str(parkTrain)"
"1","'data.frame':	"
"1",""
"1","713"
"1",""
"1"," obs. of  "
"1",""
"1","4"
"1",""
"1"," variable"
"1",""
"1","s"
"1",""
"1",":"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","city                   "
"1",""
"1",":"
"1"," chr  "
"1",""
"1","""Charlotte"" ""Charlotte"" ""Charlotte"" ""Charlotte"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","pct_near_park_data     "
"1",""
"1",":"
"1"," num  "
"1",""
"1","26 28 26 27 27 37 42 43 27 36"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","spend_per_resident_data"
"1",""
"1",":"
"1"," num  "
"1",""
"1","78.9 47 77.3 69 51"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","park_pct_city_data     "
"1",""
"1",":"
"1"," num  "
"1",""
"1","4.1 4 5.01 5.1 5.6 11 11 11 4 6"
"1",""
"1"," ..."
"1",""
"1","
"
"0","# Set seed for reproducibility"
"0","set.seed(278613)"
"0",""
"0","# Perform k-means clustering using only the numeric columns"
"0","park_model <- kmeans(x = parkTrain[, c(""pct_near_park_data"", ""spend_per_resident_data"", ""park_pct_city_data"")], centers = 5)"
"0",""
"0",""
"0","parkTrain$cluster <- park_model$cluster"
"0","# Create the ggplot"
"0","ggplot(parkTrain, aes(x = pct_near_park_data, y = spend_per_resident_data, color = factor(cluster))) +"
"0","  geom_point(size = 3) +  # Use points with a specified size"
"0","  labs("
"0","    title = ""K-means Clustering of Cities"","
"0","    subtitle=""Grouping by Similarity"","
"0","    x = ""Percent Near Park Data"","
"0","    y = ""Spending Per Resident"","
"0","    color = ""Clusters""  # Legend title"
"0","  ) +"
"0","  scale_color_viridis_d() +  # Use viridis color scale for clusters+"
"0","  xlim(0, 100)"
